"""
全局配置
"""

import os
from pathlib import Path

# 脚本所在目录，所有数据都存在这下面
BASE_DIR = Path(__file__).parent.resolve()

# ============================================================
# API 配置
# ============================================================

DASHSCOPE_API_KEY = os.environ.get("DASHSCOPE_API_KEY", "")
QWEN_MODEL = "qwen-plus"

# ============================================================
# Whisper 配置
# ============================================================

WHISPER_MODEL = "medium"
WHISPER_LANGUAGE = "zh"
CHUNK_DURATION_SECONDS = 10 * 60

# ============================================================
# 目录配置（全部在脚本目录下）
# ============================================================

# 输入：用户上传的原始录音会复制到这里
INPUT_DIR = BASE_DIR / "data" / "input"

# 中间文件：音频切片、分段转写结果
TEMP_DIR = BASE_DIR / "data" / "temp"

# 输出：最终的转写全文和会议总结
OUTPUT_DIR = BASE_DIR / "data" / "output"

# 任务记录：持久化 completed_tasks
TASKS_DB_PATH = BASE_DIR / "data" / "tasks.json"

# 确保目录存在
for d in [INPUT_DIR, TEMP_DIR, OUTPUT_DIR]:
    d.mkdir(parents=True, exist_ok=True)

# ============================================================
# 总结 Prompt
# ============================================================

SINGLE_SUMMARY_PROMPT = """你是一个专业的会议记录助手。请根据以下会议转写文本，生成一份结构化的会议纪要。

要求：
1. 会议主题/背景概述
2. 关键讨论要点（按议题分类）
3. 各方立场和观点（如能识别不同发言人）
4. 达成的共识或决议
5. 待办事项和行动项（如有）
6. 未解决的分歧或待确认事项（如有）

请用中文输出，保持客观准确，不要添加转写文本中没有的信息。

---
会议转写文本：

{transcript}
"""

CHUNK_EXTRACT_PROMPT = """请提取以下会议文本片段的关键要点，保留重要细节、数据和决策内容：

{chunk}
"""

MERGE_SUMMARY_PROMPT = """你是一个专业的会议记录助手。以下是多段会议录音的要点摘要，它们属于同一个会议/主题。
请合并这些内容，生成一份完整的结构化会议纪要。

要求：
1. 会议主题/背景概述
2. 关键讨论要点（按议题分类）
3. 各方立场和观点（如能识别不同发言人）
4. 达成的共识或决议
5. 待办事项和行动项（如有）
6. 未解决的分歧或待确认事项（如有）

去除重复内容，按逻辑顺序组织，保持客观准确。

---
各段要点：

{summaries}
"""
